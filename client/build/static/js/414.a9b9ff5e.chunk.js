"use strict";(self.webpackChunkimage_gallery_client=self.webpackChunkimage_gallery_client||[]).push([[414],{2874:function(e,t,r){var n=r(184);t.Z=function(e){var t=e.onFileSelect;return(0,n.jsx)("div",{children:(0,n.jsx)("input",{className:"border border-gray-200 w-full rounded-md mb-3",type:"file",onChange:function(e){t(e.target.files[0])}})})}},6131:function(e,t,r){var n=r(9439),a=r(2791),i=r(2874),s=r(184);t.Z=function(e){var t=e.categoryData,r=e.submitFn,o=e.isUploadLoading,u=e.isUploadError,l=e.uploadError,c=e.method,d=e.imageData,h=(0,a.useState)(d?d.image.title:""),f=(0,n.Z)(h,2),m=f[0],p=f[1],g=(0,a.useState)(d?d.image.desc:""),v=(0,n.Z)(g,2),x=v[0],y=v[1],b=(0,a.useState)(d?d.image.category._id:""),Z=(0,n.Z)(b,2),N=Z[0],P=Z[1],j=(0,a.useState)(null),w=(0,n.Z)(j,2),k=w[0],O=w[1],R=(0,a.useState)(!1),E=(0,n.Z)(R,2),C=E[0],M=E[1];return(0,s.jsxs)("div",{className:"m-5 p-5 w-96 shadow-md shadow-gray-200",style:{fontFamily:"Quicksand"},children:[(0,s.jsxs)("h2",{className:"text-xl font-bold text-center",children:["create"===c?"Upload":"Edit"," your image"]}),o&&(0,s.jsx)("p",{className:"bg-green-200 mb-3 rounded text-center px-5",children:(0,s.jsx)("span",{className:"animate-pulsetacking-wider font-bold text-green-600 mb-3",children:"Photo Uploading ...."})}),u&&(0,s.jsx)("p",{className:"text-red-400 text-sm bg-red-100 px-3 py-1 rounded mb-3",children:null===l||void 0===l?void 0:l.info.message}),C&&(0,s.jsx)("p",{className:"text-red-400 text-sm bg-red-100 px-3 py-1 rounded mb-3",children:"Fill up all fields"}),(0,s.jsxs)("form",{onSubmit:function(e){if(e.preventDefault(),""!==m&&""!==N&&""!==x){var t=new FormData;t.append("title",m),t.append("desc",x),t.append("category",N),"create"===c&&t.append("image",k),r(t)}else M(!0)},children:[(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("label",{htmlFor:"image-title",children:"Title"}),(0,s.jsx)("input",{className:"border border-gray-300 rounded-md px-3 py-1 w-full mb-3",type:"text",id:"image-title",value:m,onChange:function(e){return p(e.target.value)}})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("label",{htmlFor:"image-category",children:"Select Category"}),(0,s.jsxs)("select",{value:N,onChange:function(e){return P(e.target.value)},className:"border border-gray-300 rounded-md px-3 py-2 w-full mb-3 bg-white",name:"category",id:"image-category",children:[(0,s.jsx)("option",{value:"",children:"Select Category"}),t.map((function(e){return(0,s.jsx)("option",{value:e._id,children:e.name},e._id)}))]})]}),(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("label",{htmlFor:"image-desc",children:"Description"}),(0,s.jsx)("textarea",{className:"border border-gray-300 rounded-md px-3 py-1 w-full mb-3",type:"text",id:"image-desc",value:x,onChange:function(e){return y(e.target.value)}})]}),"create"===c&&(0,s.jsx)(i.Z,{onFileSelect:function(e){return O(e)}}),(0,s.jsx)("button",{type:"submit",className:"bg-orange-500 text-white rounded-md px-3 py-1",children:"create"===c?"Add Photo":"Edit Photo"})]})]})}},580:function(e,t,r){r.r(t),r.d(t,{default:function(){return b}});var n=r(4165),a=r(5861),i=r(1413),s=r(9439),o=r(2791),u=r(1087),l=r(184),c=function(e){var t=e.image;return(0,l.jsx)(u.rU,{to:"/image/".concat(t._id,"/").concat(t.slug),className:"rounded-md flex w-[180px] h-[180px]",children:(0,l.jsx)("img",{src:t.url,alt:"",className:"rounded-md w-full h-full transition duration-300 ease-out hover:brightness-50"})})},d=r(7689),h=r(8820),f=r(456),m=r(5893),p=r(6131),g=r(5439),v=r(3418),x=r(7858),y=r(9645),b=function(){var e,t,r=(0,d.UO)("userId"),u=(0,d.V4)("root"),b=(0,o.useState)(!1),Z=(0,s.Z)(b,2),N=Z[0],P=Z[1];u&&"EXPIRED"!==u&&(t=(0,f.Z)(u));var j,w=(0,g.a)({queryKey:["categories"],queryFn:function(){return(0,y.pE)()}}),k=w.data,O=(w.isError,w.error,(0,v.D)({mutationFn:y.mh,onSuccess:function(){y.Eh.invalidateQueries({queryKey:["images"]}),P(!1)}})),R=O.mutate,E=O.isLoading,C=O.isError,M=O.error,S=(0,x.N)({queryKey:["images",{user:r.userId}],queryFn:function(e){var t=e.pageParam,r=void 0===t?1:t,n=e.queryKey;return(0,y._6)((0,i.Z)({pageParam:r},n[1]))},getNextPageParam:function(e,t){return e.data.hasNextPage?e.data.nextPage:void 0}}),F=S.data,_=S.hasNextPage,L=S.fetchNextPage;S.isFetchingNextPage;return(0,o.useEffect)((function(){var e=!1,t=function(){var t=(0,a.Z)((0,n.Z)().mark((function t(r){var a,i,s,o;return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=r.target.scrollingElement,i=a.scrollHeight,s=a.scrollTop,o=a.clientHeight,e||!(i-s<=1.2*o)){t.next=7;break}if(e=!0,!_){t.next=6;break}return t.next=6,L();case 6:e=!1;case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return document.addEventListener("scroll",t),function(){document.removeEventListener("scroll",t)}}),[]),F&&(j=F.pages.map((function(e){return e.data.docs.map((function(e){return(0,l.jsx)(c,{image:e},e._id)}))}))),(0,l.jsxs)("div",{className:"flex flex-col md:flex-row flex-wrap gap-5 my-5",children:[j,r.userId===(null===(e=t)||void 0===e?void 0:e._id)?(0,l.jsx)("button",{onClick:function(){return P(!0)},className:"w-[180px] h-[180px] rounded bg-gray-100 hover:bg-gray-200 ease-in duration-300",children:(0,l.jsx)(h.Lfi,{className:"scale-150 mx-auto text-gray-400"})}):null,(0,l.jsx)(m.Z,{isVisible:N,onClose:function(){return P(!1)},children:(0,l.jsx)(p.Z,{submitFn:function(e){R({formData:e,token:u})},isUploadLoading:E,isUploadError:C,uploadError:M,categoryData:k,method:"create"})})]})}},5893:function(e,t,r){r(2791);var n=r(184);t.Z=function(e){var t=e.isVisible,r=e.onClose,a=e.children;if(!t)return null;return(0,n.jsx)("div",{onClick:function(e){"modalWrapper"===e.target.id&&r()},id:"modalWrapper",className:"fixed inset-0 bg-black bg-opacity-25 backdrop-blur-sm flex justify-center items-center",children:(0,n.jsxs)("div",{className:"max-w-[800px] flex flex-col",children:[(0,n.jsx)("button",{onClick:r,className:"text-white text-xl place-self-end",children:"X"}),(0,n.jsx)("div",{className:"bg-white p-2 rounded",children:a})]})})}},9983:function(e,t,r){r.d(t,{w_:function(){return l}});var n=r(2791),a={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},i=n.createContext&&n.createContext(a),s=function(){return s=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},s.apply(this,arguments)},o=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]])}return r};function u(e){return e&&e.map((function(e,t){return n.createElement(e.tag,s({key:t},e.attr),u(e.child))}))}function l(e){return function(t){return n.createElement(c,s({attr:s({},e.attr)},t),u(e.child))}}function c(e){var t=function(t){var r,a=e.attr,i=e.size,u=e.title,l=o(e,["attr","size","title"]),c=i||t.size||"1em";return t.className&&(r=t.className),e.className&&(r=(r?r+" ":"")+e.className),n.createElement("svg",s({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,a,l,{className:r,style:s(s({color:e.color||t.color},t.style),e.style),height:c,width:c,xmlns:"http://www.w3.org/2000/svg"}),u&&n.createElement("title",null,u),e.children)};return void 0!==i?n.createElement(i.Consumer,null,(function(e){return t(e)})):t(a)}},7858:function(e,t,r){r.d(t,{N:function(){return x}});var n=r(3734),a=r(4925),i=r(1413),s=r(5671),o=r(3144),u=r(1752),l=r(1120),c=r(136),d=r(7277),h=r(1135),f=r(2806),m=["pageParam"],p=["pageParam"],g=function(e){(0,c.Z)(r,e);var t=(0,d.Z)(r);function r(e,n){return(0,s.Z)(this,r),t.call(this,e,n)}return(0,o.Z)(r,[{key:"bindMethods",value:function(){(0,u.Z)((0,l.Z)(r.prototype),"bindMethods",this).call(this),this.fetchNextPage=this.fetchNextPage.bind(this),this.fetchPreviousPage=this.fetchPreviousPage.bind(this)}},{key:"setOptions",value:function(e,t){(0,u.Z)((0,l.Z)(r.prototype),"setOptions",this).call(this,(0,i.Z)((0,i.Z)({},e),{},{behavior:(0,f.Gm)()}),t)}},{key:"getOptimisticResult",value:function(e){return e.behavior=(0,f.Gm)(),(0,u.Z)((0,l.Z)(r.prototype),"getOptimisticResult",this).call(this,e)}},{key:"fetchNextPage",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.pageParam,r=(0,a.Z)(e,m);return this.fetch((0,i.Z)((0,i.Z)({},r),{},{meta:{fetchMore:{direction:"forward",pageParam:t}}}))}},{key:"fetchPreviousPage",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.pageParam,r=(0,a.Z)(e,p);return this.fetch((0,i.Z)((0,i.Z)({},r),{},{meta:{fetchMore:{direction:"backward",pageParam:t}}}))}},{key:"createResult",value:function(e,t){var n,a,s,o,c,d,h=e.state,m=(0,u.Z)((0,l.Z)(r.prototype),"createResult",this).call(this,e,t),p=m.isFetching,g=m.isRefetching,v=p&&"forward"===(null==(n=h.fetchMeta)||null==(a=n.fetchMore)?void 0:a.direction),x=p&&"backward"===(null==(s=h.fetchMeta)||null==(o=s.fetchMore)?void 0:o.direction);return(0,i.Z)((0,i.Z)({},m),{},{fetchNextPage:this.fetchNextPage,fetchPreviousPage:this.fetchPreviousPage,hasNextPage:(0,f.Qy)(t,null==(c=h.data)?void 0:c.pages),hasPreviousPage:(0,f.ZF)(t,null==(d=h.data)?void 0:d.pages),isFetchingNextPage:v,isFetchingPreviousPage:x,isRefetching:g&&!v&&!x})}}]),r}(h.z),v=r(8560);function x(e,t,r){var a=(0,n._v)(e,t,r);return(0,v.r)(a,g)}},3418:function(e,t,r){r.d(t,{D:function(){return v}});var n=r(1413),a=r(9439),i=r(2791),s=r(3734),o=r(5671),u=r(3144),l=r(136),c=r(7277),d=r(9054),h=r(9538),f=function(e){(0,l.Z)(r,e);var t=(0,c.Z)(r);function r(e,n){var a;return(0,o.Z)(this,r),(a=t.call(this)).client=e,a.setOptions(n),a.bindMethods(),a.updateResult(),a}return(0,u.Z)(r,[{key:"bindMethods",value:function(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}},{key:"setOptions",value:function(e){var t,r=this.options;this.options=this.client.defaultMutationOptions(e),(0,s.VS)(r,this.options)||this.client.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.currentMutation,observer:this}),null==(t=this.currentMutation)||t.setOptions(this.options)}},{key:"onUnsubscribe",value:function(){var e;this.hasListeners()||(null==(e=this.currentMutation)||e.removeObserver(this))}},{key:"onMutationUpdate",value:function(e){this.updateResult();var t={listeners:!0};"success"===e.type?t.onSuccess=!0:"error"===e.type&&(t.onError=!0),this.notify(t)}},{key:"getCurrentResult",value:function(){return this.currentResult}},{key:"reset",value:function(){this.currentMutation=void 0,this.updateResult(),this.notify({listeners:!0})}},{key:"mutate",value:function(e,t){return this.mutateOptions=t,this.currentMutation&&this.currentMutation.removeObserver(this),this.currentMutation=this.client.getMutationCache().build(this.client,(0,n.Z)((0,n.Z)({},this.options),{},{variables:"undefined"!==typeof e?e:this.options.variables})),this.currentMutation.addObserver(this),this.currentMutation.execute()}},{key:"updateResult",value:function(){var e=this.currentMutation?this.currentMutation.state:(0,d.R)(),t=(0,n.Z)((0,n.Z)({},e),{},{isLoading:"loading"===e.status,isSuccess:"success"===e.status,isError:"error"===e.status,isIdle:"idle"===e.status,mutate:this.mutate,reset:this.reset});this.currentResult=t}},{key:"notify",value:function(e){var t=this;h.V.batch((function(){var r,n,a,i;if(t.mutateOptions&&t.hasListeners())if(e.onSuccess)null==(r=(n=t.mutateOptions).onSuccess)||r.call(n,t.currentResult.data,t.currentResult.variables,t.currentResult.context),null==(a=(i=t.mutateOptions).onSettled)||a.call(i,t.currentResult.data,null,t.currentResult.variables,t.currentResult.context);else if(e.onError){var s,o,u,l;null==(s=(o=t.mutateOptions).onError)||s.call(o,t.currentResult.error,t.currentResult.variables,t.currentResult.context),null==(u=(l=t.mutateOptions).onSettled)||u.call(l,void 0,t.currentResult.error,t.currentResult.variables,t.currentResult.context)}e.listeners&&t.listeners.forEach((function(e){(0,e.listener)(t.currentResult)}))}))}}]),r}(r(5511).l),m=r(7413),p=r(6403),g=r(9608);function v(e,t,r){var o=(0,s.lV)(e,t,r),u=(0,p.NL)({context:o.context}),l=i.useState((function(){return new f(u,o)})),c=(0,a.Z)(l,1)[0];i.useEffect((function(){c.setOptions(o)}),[c,o]);var d=(0,m.$)(i.useCallback((function(e){return c.subscribe(h.V.batchCalls(e))}),[c]),(function(){return c.getCurrentResult()}),(function(){return c.getCurrentResult()})),v=i.useCallback((function(e,t){c.mutate(e,t).catch(x)}),[c]);if(d.error&&(0,g.L)(c.options.useErrorBoundary,[d.error]))throw d.error;return(0,n.Z)((0,n.Z)({},d),{},{mutate:v,mutateAsync:d.mutate})}function x(){}},5439:function(e,t,r){r.d(t,{a:function(){return s}});var n=r(3734),a=r(1135),i=r(8560);function s(e,t,r){var s=(0,n._v)(e,t,r);return(0,i.r)(s,a.z)}}}]);
//# sourceMappingURL=414.a9b9ff5e.chunk.js.map