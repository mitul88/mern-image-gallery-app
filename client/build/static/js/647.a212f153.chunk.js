"use strict";(self.webpackChunkimage_gallery_client=self.webpackChunkimage_gallery_client||[]).push([[647],{4647:function(e,t,r){r.r(t),r.d(t,{action:function(){return m},default:function(){return u}});var a=r(4165),s=r(5861),n=(r(2791),r(1989)),i=r(9439),o=r(7689),l=r(1087),d=r(184),c=function(){var e=(0,o.nA)(),t=(0,l.lr)(),r=(0,i.Z)(t,1)[0],a=(0,o.HJ)(),s="login"===r.get("mode"),n="submitting"===a.state;return(0,d.jsxs)("div",{className:"p-1 w-96 md:w-2/5",children:[(0,d.jsxs)(l.l0,{method:"post",children:[(0,d.jsx)("h1",{className:"text-3xl my-5 font-bold tracking-widest",children:s?"Log in to your account":"Create a new user"}),e&&DataTransfer.errors&&(0,d.jsx)("ul",{children:Object.values(e.errors).map((function(e){return(0,d.jsx)("li",{children:e},e)}))}),!s&&(0,d.jsxs)("div",{className:"m-auto flex flex-col",children:[(0,d.jsx)("label",{htmlFor:"name",children:"Name"}),(0,d.jsx)("input",{type:"name",name:"name",id:"name",required:!0,className:"rounded-md my-2 p-2 border-2 border-gray-500 bg-sky-900"})]}),e&&e.message&&(0,d.jsx)("p",{className:"px-3 py-1 rounded text-white bg-red-700 text-lg font-semibold tracking-wider text-center",children:e.message}),(0,d.jsxs)("div",{className:"m-auto flex flex-col",children:[(0,d.jsx)("label",{htmlFor:"email",children:"Email"}),(0,d.jsx)("input",{type:"email",name:"email",id:"email",required:!0,className:"rounded-md my-2 p-2 border-2 border-gray-500 bg-sky-900"})]}),(0,d.jsxs)("div",{className:"m-auto flex flex-col",children:[(0,d.jsx)("label",{htmlFor:"password",children:"Password"}),(0,d.jsx)("input",{type:"password",name:"password",id:"password",required:!0,className:"rounded-md my-2 p-2 border-2 border-gray-500 bg-sky-900"})]}),(0,d.jsx)("button",{className:"px-5 py-2 rounded-md bg-orange-600 text-white font-semibold tracking-wider",style:{fontFamily:"Quicksand"},disabled:n,children:n?"Submitting":s?"Login":"Register"})]}),(0,d.jsxs)("div",{className:"flex flex-row items-center mt-[50px]",children:[(0,d.jsx)("p",{className:"tracking-wider",children:s?"Don't have any account ?":"Already have an account ? "}),(0,d.jsx)(l.rU,{to:"?mode=".concat(s?"register":"login"),className:"mx-2 py-1 px-3 rounded-md border-2 border-gray-500 font-semibold",style:{fontFamily:"Quicksand"},children:s?"Create new user":"Login"})]}),(0,d.jsx)(l.rU,{to:"/",className:"py-1 rounded-md font-medium underline",children:"Back to Home"})]})},m=function(){var e=(0,s.Z)((0,a.Z)().mark((function e(t){var r,s,i,o,l,d,c,m,u;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.request,s=new URL(r.url).searchParams,"login"===(i=s.get("mode")||"login")||"register"===i){e.next=5;break}throw(0,n.AV)({message:"Unsupported mode"},{status:422});case 5:return e.next=7,r.formData();case 7:return o=e.sent,l={email:o.get("email"),password:o.get("password")},"register"===i&&(l.name=o.get("name")),e.next=12,fetch("https://galleria.cyclic.app/api/auth/"+i,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)});case 12:if(422!==(d=e.sent).status&&401!==d.status&&400!==d.status){e.next=15;break}return e.abrupt("return",d);case 15:if(d.ok){e.next=17;break}throw(0,n.AV)({message:"Could not authenticate user, Please try again later"},{status:500});case 17:return e.next=19,d.json();case 19:return c=e.sent,m=c.token,localStorage.setItem("token",m),(u=new Date).setHours(u.getHours()+1),localStorage.setItem("expiration",u.toISOString()),e.abrupt("return",(0,n.uX)("/"));case 26:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),u=function(){return(0,d.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-sky-950 text-white",children:(0,d.jsx)(c,{})})}}}]);
//# sourceMappingURL=647.a212f153.chunk.js.map